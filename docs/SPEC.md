# Active Recall Scheduler 仕様書

## 1. 概要

学習項目ごとに定義された「忘却曲線に基づく復習タイミング」をリスト化し、ユーザーが各タイミングでのアクティブリコール実施有無を個別に管理（完了登録）できる仕組みを提供する。

## 2. 復習間隔の定義（スケジュール）

学習完了日（Day 0）を基準として、以下のタイミングで復習タスクを発生させる。

1. **学習直後** (Day 0)
2. **1日後** (Day 1)
3. **3日後** (Day 3)
4. **1週間後** (Day 7)
5. **2週間後** (Day 14)
6. **1ヶ月後** (Day 30)
7. **3ヶ月後** (Day 90)
8. **半年後** (Day 180)
9. **1年後** (Day 365)
10. **以降、1年ごと** (Day 730, Day 1095...)

## 3. 機能要件

### 3.1 復習タスクの生成

* ユーザーが新しい項目を「学習した」と登録した時点で、上記スケジュールに基づいた**復習タスク（インスタンス）を一括、または順次生成**する。
* 各タスクには「予定日」と「ステータス（未完了/完了）」を持たせる。

### 3.2 完了処理（アクティブリコール実施記録）

* **手動完了:** 期間が来たからといって自動的に完了にはしない。ユーザーがアクティブリコールを行い、UI上の「完了」ボタン（またはチェックボックス）を押下することで、その回（例：1週間後の回）を完了状態とする。
* **順序性:** 基本的にはスケジュールの早い順に消化することを想定するが、システム的には過去の未完了分をまとめて完了にすることも可能とする（※要件により厳格化も可能）。

### 3.3 以降1年ごとの処理

* 「1年後」のタスクが完了されたタイミングで、自動的に「さらに1年後（+365日）」のタスクを新規作成し、リストに追加する。

## 4. データ構造案（概念モデル）

システム内部では、学習項目（Parent）と、それに紐づく復習タスク（Child）の 1対多 の関係で管理する。

**A. 学習アイテム (LearningItem)**

* ID
* タイトル / 内容
* 学習開始日 (Created_at)

**B. 復習タスク (ReviewTask)**

* ID
* 学習アイテムID (Foreign Key)
* **ステージ名** (例: "1週間後", "3ヶ月後")
* **予定日** (Due_Date)
* **ステータス** (Status: `Pending` | `Ready` | `Completed`)
* **完了日** (Completed_at: 実際にユーザーがチェックした日時)

## 5. UI/UX イメージ

### ダッシュボード / リスト表示

* 「本日やるべき復習タスク」として、予定日が到来している（かつ未完了の）`ReviewTask` を一覧表示する。
* 各タスクの横にチェックボックスを配置する。

### 詳細画面表示

1つの学習項目に対し、ロードマップのような形式で進捗を表示する。

> **【単語：Algorithm】の復習状況**
> * [x] **学習直後** (完了日: 2024/01/01)
> * [x] **1日後** (完了日: 2024/01/02)
> * [ ] **3日後** (予定日: 2024/01/05) ← **今ここ（アクティブ）**
> * [ ] **1週間後** (予定日: 2024/01/09)
> * [ ] **2週間後** (予定日: 2024/01/16)
> ...
> 
> 

## 6. ロジック変更点（前案との比較）

| 項目 | 変更前（自動更新型） | **変更後（個別タスク型）** |
| --- | --- | --- |
| **日付管理** | 「次回実施日」という1つのフィールドを更新し続ける | **「実施予定リスト」を持ち、各回のレコードを保持する** |
| **完了条件** | ボタンを押すと日付が計算されて未来へ飛ぶ | **ボタンを押すと「今回のタスク」が完了になり、履歴に残る** |
| **メリット** | データが軽量 | **「いつ復習したか」の履歴が正確に残る。「3日後をサボって1週間後をやった」等の管理が可能になる** |

---

この仕様により、「勝手に完了扱いにならず、自分がやったタイミングで確実にチェックを入れる（達成感を積み上げる）」形式になります。

このデータ構造（1対多のリレーション）で実装を進めてもよろしいでしょうか？それともUI部分についてもう少し詰めたい箇所はありますか？